# 自动精灵IDE 使用说明

## 简介

自动精灵IDE是一款专为自动精灵脚本开发设计的集成开发环境，提供智能代码提示、AI辅助编写、节点库管理、图片自动编码、ZJS打包等功能。

## 功能特性

- **智能代码提示** - 自动精灵API自动补全和悬停提示
- **节点库管理** - 从GitHub导入和管理节点库
- **图片自动编码** - 自动将图片转换为base64编码
- **AI辅助编写** - 集成DeepSeek AI助手，智能生成代码
- **ZJS打包** - 一键导出为ZJS格式文件

## 快速开始

### 安装

1. 下载最新版本的安装包
2. 运行安装程序完成安装
3. 首次启动时会提示设置DeepSeek API密钥

### 创建项目

1. 点击 **新建项目** 或使用快捷键 `Ctrl+N`
2. 输入项目名称
3. 选择项目保存位置
4. 点击 **创建项目**

项目目录结构：
```
项目名称/
├── main/
│   ├── main.js           # 主脚本文件
│   └── pictures/         # 图片资源目录
├── listening/
│   ├── 每个动作运行前监听.js
│   ├── 每个动作运行结束后.js
│   ├── 错误.js
│   ├── 列表开头监听.js
│   └── 脚本开始前监听.js
└── Information/
    ├── project.json      # 项目信息
    └── header.json       # ZJS头部配置
```

### 打开项目

1. 点击 **打开项目** 或使用快捷键 `Ctrl+O`
2. 选择项目目录
3. 项目文件将显示在左侧文件树中

## 编辑器功能

### 代码提示

输入 `zdjl.` 后会自动弹出API提示：

```javascript
zdjl.toast  // 显示提示
zdjl.click  // 点击坐标
zdjl.swipe  // 滑动操作
```

### 悬停提示

将鼠标悬停在API名称上，会显示详细的参数说明和示例代码。

### 节点库提示

输入 `node: ` 后会弹出节点选择面板：

```javascript
// 输入 node: 后显示节点列表
const result = node: 
```

### 快捷键

| 快捷键 | 功能 |
|--------|------|
| `Ctrl+S` | 保存当前文件 |
| `Ctrl+N` | 新建项目 |
| `Ctrl+O` | 打开项目 |
| `Ctrl+E` | 导出ZJS |
| `Ctrl+R` | 重新加载 |
| `F12` | 开发者工具 |

## AI助手

### 设置API密钥

1. 首次启动时会提示设置API密钥
2. 或通过菜单 **帮助** → **设置API密钥** 进行修改
3. API密钥存储在本地，不会上传到服务器

### 使用AI助手

AI助手面板位于编辑器右侧，支持以下功能：

- **代码生成** - 描述需求，AI自动生成代码
- **代码解释** - 解释当前代码的功能和逻辑
- **代码优化** - 优化代码性能和可读性

### 示例对话

```
用户: 帮我写一个循环点击的脚本

AI: 
```javascript
// 循环点击示例
for (let i = 0; i < 10; i++) {
    zdjl.click(500, 800);
    await new Promise(r => setTimeout(r, 1000));
}
zdjl.toast("循环完成");
```
```

## 节点库管理

### 导入节点库

1. 点击菜单 **节点库** → **导入节点库**
2. 输入GitHub仓库地址
3. 点击 **导入**

### 管理节点库

1. 点击菜单 **节点库** → **管理节点库**
2. 查看已导入的节点库列表
3. 可以刷新或删除节点库

### 节点库格式

节点库需要遵循特定格式，详见《节点库开发指南》。

## 导出ZJS

### 导出步骤

1. 打开项目并编辑主脚本
2. 点击菜单 **文件** → **导出为ZJS** 或使用快捷键 `Ctrl+E`
3. 配置导出选项：
   - 脚本描述
   - 重复次数
   - 失败暂停
   - 最小版本号
4. 点击 **导出** 选择保存位置

### 图片处理

脚本中引用的图片会自动转换为base64编码：

```javascript
// 使用 @picture 或 @img 引用图片
zdjl.findLocation({
    type: "image",
    imageData: @picture("button.png")
}, false);
```

导出时会自动查找 `main/pictures/` 目录下的图片文件并转换。

### 监听脚本

以下监听脚本会自动合并到ZJS文件中：

- `每个动作运行前监听.js` → `beforeEveryScript`
- `每个动作运行结束后.js` → `afterEveryScriptFinish`
- `错误.js` → `afterEveryScriptFail`
- `列表开头监听.js` → `beforeEveryLoop`
- `脚本开始前监听.js` → `beforeFirstLoop`

## 项目配置

### project.json

```json
{
  "name": "项目名称",
  "version": "1.0.0",
  "description": "项目描述",
  "author": "作者",
  "createdAt": "2024-01-01T00:00:00.000Z",
  "updatedAt": "2024-01-01T00:00:00.000Z"
}
```

### header.json

ZJS文件头部配置：

```json
{
  "repeatCount": -1,
  "pauseOnFail": true,
  "count": 1,
  "minVerCode": 2015000,
  "minVerName": "2.15.0",
  "description": "脚本描述"
}
```

## 常见问题

### Q: AI助手无法使用？

A: 请检查：
1. 是否已设置DeepSeek API密钥
2. 网络连接是否正常
3. API密钥是否有效

### Q: 导入节点库失败？

A: 请检查：
1. GitHub仓库是否为公开仓库
2. 仓库结构是否符合规范
3. 网络连接是否正常

### Q: 图片无法转换？

A: 请检查：
1. 图片是否放在 `main/pictures/` 目录
2. 图片格式是否支持（PNG、JPG）
3. 引用语法是否正确

### Q: 导出的ZJS文件无法运行？

A: 请检查：
1. 自动精灵版本是否满足最低要求
2. 脚本语法是否正确
3. 图片路径是否正确

## 快捷操作

### 文件操作

- 双击文件树中的文件打开编辑
- 点击文件标签的 × 关闭文件
- 文件修改后会显示未保存标记

### 编辑器操作

- 支持多标签编辑
- 支持代码折叠
- 支持括号匹配高亮

## 技术支持

如遇问题，请通过以下方式获取帮助：

- 查看自动精灵官方文档
- 在GitHub提交Issue
- 加入社区讨论群

---

版本：1.0.0
更新日期：2024年
